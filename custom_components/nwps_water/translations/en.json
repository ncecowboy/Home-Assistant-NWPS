{
  "config": {
    "step": {
      "user": {
        "title": "Configure NWPS Water",
        "data": {
          "station_id": "Station ID",
          "parameters": "Parameters to expose",
          "scan_interval": "Update interval (seconds)"
        }
      }
    }
  },
  "sensor": {
    "state": {
      "stage": "Stage",
      "flow": "Flow",
      "forecast_stage": "Forecast Stage",
      "forecast_flow": "Forecast Flow"
    }
  },
  "binary_sensor": {
    "state": {
      "observed_flood": "Observed Flood",
      "forecast_flood": "Forecast Flood"
    }
  },
  "system_health": {
    "info": {
      "version": "Version"
    }
  }
}
``` ````

````markdown name=README.md
```markdown
# NWPS Water - Home Assistant custom integration

This integration fetches selected water data from NOAA NWPS (National Water Prediction Service) and exposes them as Home Assistant sensors and binary sensors.

Features
- Sensors for stage, flow (normalized to cfs where possible), forecast values, images (hydrograph / probabilistic), and station photo.
- Binary sensors that indicate observed or forecast flood conditions (minor/moderate/major).
- Device information (station name, coordinates) and raw NWPS JSON available in entity attributes for inspection.
- Default polling interval: 5 minutes (configurable).

Example station
- COCO3 (Clackamas River near Oregon City) — sample JSON structure used to tune parsing.

Images and links
- Hydrograph / flood images are provided in entity attributes when available.
- Example NOAA / NWPS docs: https://api.water.noaa.gov/nwps/v1/docs/
- NOAA logo (optional): https://www.weather.gov/images/logos/NOAA_shield.png

Installation (local development)
1. Copy `custom_components/nwps_water` into your Home Assistant `config` directory.
2. Restart Home Assistant.
3. Go to Settings → Devices & Services → Add Integration → search for "NWPS Water".
4. Enter the station ID (e.g., COCO3), select parameters to expose, and save.

Notes on parsing
- The coordinator fetches the station endpoint (`/stations/{station_id}`) and parses `status.observed` and `status.forecast` blocks, along with images and flood category/thresholds.
- Some NWPS responses use units like `kcfs` (thousand cfs). The integration multiplies those values to provide Flow in `cfs` where possible and exposes the original units in attributes.
- Raw JSON is stored in each entity attribute under `raw` — use this to inspect additional fields and extend the integration.

Debugging
Enable debug logging for development:
```yaml
logger:
  default: info
  logs:
    custom_components.nwps_water: debug
```

Publishing to HACS
1. Push this repository to GitHub.
2. In HACS → Integrations → three-dot menu → Custom repositories → add your repo URL and choose "Integration".
3. Install via HACS, restart Home Assistant, and add the integration.

License
- Add a LICENSE file of your choice.
```
``` ````

Notes and next steps
- The coordinator now specifically fetches /stations/{station_id} and parses fields present in your COCO3 example: status.observed/forecast, flood.categories, images.hydrograph/photos, dataAttribution, latitude/longitude, and more.
- Flow values that use a kilo prefix (e.g., "kcfs") are converted to cfs automatically and the original units are kept in attributes.
- Sensors created by default: keys listed in const.AVAILABLE_PARAMETERS. You can customize the parameter list when adding the integration.
- Binary sensors created: observed_flood and forecast_flood (active when category is 'minor' or greater).

If you want, I can:
- Produce the exact git patch (files ready to push) or push these files into your GitHub repo (provide owner/repo and confirm).
- Add device coordinates into the Device registry display (some HA device map fields require specific handling) — I can enhance DeviceInfo to include coordinates if desired.
- Add unit conversions (°C/°F) or more granular sensors (e.g., individual crest historic sensors) next. Which of these should I do next?